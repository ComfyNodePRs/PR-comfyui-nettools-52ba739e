rewrite from https://github.com/Acly/comfyui-tooling-nodes